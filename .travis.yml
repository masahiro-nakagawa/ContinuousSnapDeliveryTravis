language: shell
dist: focal
os: linux
env:
  global:
  - SNAPCRAFT_BUILD_ENVIRONMENT: lxd
  - secure: chYs0QUpfWMzCdLG/uUiIMcLNlJ0tvSXXvXYcYz4sSK0E7FhUI6u0XEKv0EcgUst0c8i71Ix9PUBQg+jDGGxC9AxJnP3sfA3ydbMx/dY3N6f3m94ZBRqG7yp+smf0bn+LQqcGDEGxM/mLmJnKA3cYmUDrmkMTtikAagHNAO0m9l54fO8FqmpAiif4i70nYSud2nLB8Bz8P1Bmc93iRFkYoKYrm5cqPJqwv/IYHx1SLT41fMGRURqf4PxpYzljYUZ5AhtjZoq/WrdeYJGhZf0Z27Yc8EZ1p60IiHblyvZLhsG6hnZ14LfuD0FlzxLCIFde+F3VcSMWOyMln6j3ZrDj14NpV0ED0u1uKUanBGjbLsxAsKlfTDGoxTqu3T+uq7j/NBb/CpRYi7t4khcbPL9DfFQmm/fGfz32VJPULe4ncIipLMAQRErkpCQOZ2d1Lm/O7vDqr7j+o7qWkRKZxOkcn+8b5PH8vV2DP6h/xgopA+ct227LxdXGDg6vFgMHvDNg1uMvP+NuJbZH7S29SF+px1Kdv7dbU62ZljZSm8ZVp9GM7b1VmONT1NlBZSTdUdQWIryQ9GeOQ6TzUk2LxMmwc9D2iLhhqZ1ObZTuA607IV1m2eOQ0iGsa/wyqAt9pCYyUN7ZsOzrwKvkhX4WTyjrn5RxNmHqjH8bIIeGIw1zWY=
before_install:
  - echo $super_secret_password
  - echo $super_secret_password | gpg --passphrase-fd 0 hello-masahiro.gpg
addons:
  snaps:
  - name: snapcraft
    channel: stable
    confinement: classic
  - name: lxd
    channel: stable
script:
- 
- echo .travis.yml
- pwd
- sudo usermod --append --groups lxd $USER
- groups
- sudo /snap/bin/lxd.migrate -yes
- sudo /snap/bin/lxd waitready
- sudo /snap/bin/lxd init --auto
- sg lxd -c snapcraft
- echo " ----Deploy-----"
- echo $SNAP_TOKEN
- echo $SNAP_TOKEN | snapcraft login --with -
- snapcraft whoami
- snapcraft upload --release=edge hello-hirotravis_2.10_amd64.snap
after_failure:
- sudo journalctl -u snapd
